tg-lightbox-close(on-close="vm.onClose()")

.form(ng-if="vm.visible")
    h2.title(translate="PROJECT.IMPORT.WHO_IS")

    p.candidate-user {{vm.user.get('full_name')}}

    div.create-project-warning
        tg-svg(svg-icon="icon-exclamation")
        span(
            translate="PROJECT.IMPORT.PROJECT_RESTRICTIONS.ACCOUNT_ALLOW_MEMBERS",
            translate-values="{'members': vm.maxMembers}"
        )

    form(ng-if="vm.mode == 'mail'", ng-submit="vm.searchUser()")
        fieldset
            p.error(ng-if="vm.invalid", translate="PROJECT.IMPORT.EMAIL_NOT_FOUND")

            label(
                translate="PROJECT.IMPORT.WRITE_EMAIL_LABEL"
                for="user-name"
            )

            .group
                input(
                    name="user-name"
                    type="text",
                    data-maxlength="500",
                    ng-model="vm.userEmail"
                )
                button.button-green.submit-button(
                    type="submit",
                    title="{{'LIGHTBOX.SEARCH.TITLE' | translate}}",
                    translate="LIGHTBOX.SEARCH.TITLE"
                )

        .search-user-mode
            p
                a(
                    href=""
                    ng-click="vm.mode = 'search'"
                ) {{'PROJECT.IMPORT.SEARCH_CONTACT' | translate}}

    div(ng-if="vm.mode == 'search'")
        fieldset
            input(
                type="text",
                data-maxlength="500",
                placeholder="{{'LIGHTBOX.ASSIGNED_TO.SEARCH' | translate}}",
                ng-model="vm.usersSearch"
            )

        .assigned-to-list
            .user-list-single(
                ng-repeat="user in vm.selectableUsers | toMutable | filter: vm.usersSearch | orderBy:'full_name_display' | limitTo: 5 as filteredCollection",
                ng-click="vm.selectUser(user)"
            )
                .user-list-avatar
                    a(
                        href="#"
                        title="{{'COMMON.ASSIGNED_TO.TITLE' | translate}}"
                    )
                        img(tg-avatar="user")
                a.user-list-name(
                    href=""
                    title="{{user.full_name_display}}"
                ) {{user.full_name_display}}

            .more-users(ng-if="filteredCollection.length >= 5")
                span(translate="COMMON.ASSIGNED_TO.TOO_MANY")

        .search-user-mode
            p
                a(
                    href=""
                    ng-click="vm.mode = 'mail'"
                ) {{'PROJECT.IMPORT.WRITE_EMAIL' | translate}}
